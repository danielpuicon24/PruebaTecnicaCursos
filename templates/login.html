{% load static %}
<!DOCTYPE html>
<html>
    <head>
        <!-- Basic Page Info -->
        <meta charset="utf-8" />
        <title>Colegio De Retos</title>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
        <!-- Site favicon -->
        <link rel="apple-touch-icon" sizes="180x180" href="{% static 'logo.svg' %}" />
        <link rel="icon"
              type="image/png"
              sizes="32x32"
              href="{% static 'logo.svg' %}"/>
        <link rel="icon"
              type="image/png"
              sizes="16x16"
              href="{% static 'logo.svg' %}"/>
        <!-- Mobile Specific Metas -->
        <meta name="viewport"
              content="width=device-width, initial-scale=1, maximum-scale=1"/>
        <!-- Google Font -->
        <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
              rel="stylesheet"/>
        <!-- CSS -->
        <link rel="stylesheet"
              type="text/css"
              href="{% static 'vendors/styles/core.css' %}"/>
        <link rel="stylesheet"
              type="text/css"
              href="{% static 'vendors/styles/icon-font.min.css' %}"/>
        <link rel="stylesheet"
              type="text/css"
              href="{% static 'vendors/styles/style.css' %}"/>
        <!-- Global site tag (gtag.js) - Google Analytics -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-GBZ3SGGX85"></script>
        <script>
			window.dataLayer = window.dataLayer || [];
			function gtag() {
				dataLayer.push(arguments);
			}
			gtag("js", new Date());

			gtag("config", "G-GBZ3SGGX85");
		
        </script>
        <!-- Google Tag Manager -->
        <script>
			(function (w, d, s, l, i) {
				w[l] = w[l] || [];
				w[l].push({ "gtm.start": new Date().getTime(), event: "gtm.js" });
				var f = d.getElementsByTagName(s)[0],
					j = d.createElement(s),
					dl = l != "dataLayer" ? "&l=" + l : "";
				j.async = true;
				j.src = "https://www.googletagmanager.com/gtm.js?id=" + i + dl;
				f.parentNode.insertBefore(j, f);
			})(window, document, "script", "dataLayer", "GTM-NXZMQSS");
		
        </script>
        <!-- End Google Tag Manager -->
    </head>
    <body class="login-page">
        <div class="login-header box-shadow">
            <div class="container-fluid d-flex justify-content-between align-items-center">
                <div class="brand-logo">
                    <a href="login.html">
                        <img src="{% static 'logo.png' %}" width="50", height="50" />
                    </a>
                </div>
                <div class="login-menu">
                    <ul>
                        <li>Colegio de Retos</li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="login-wrap d-flex align-items-center flex-wrap justify-content-center">
            <div class="container">
                <div class="row align-items-center">
                    <div class="col-md-6 col-lg-7">
                        <img src="{% static 'vendors/images/login-page-img.png' %}" alt="" />
                    </div>
                    <div class="col-md-6 col-lg-5">
                        <div class="login-box bg-white box-shadow border-radius-10">
                            <!-- this div displays our response from the ajax post -->
                            <div class="login-title">
                                <h2 class="text-center text-primary">Iniciar Sesion</h2>
                            </div>
                            <form class='login-form'>
                                {% csrf_token %}
                                <div class="input-group custom">
                                    <input type="text"
                                           class="form-control form-control-lg"
                                           placeholder="Username"
                                           required=""
                                           name="username"
                                           maxlength="150"
                                           id="id_username"
                                           autofocus=""/>
                                    <div class="input-group-append custom">
                                    <span class="input-group-text"><i class="icon-copy dw dw-user1"></i
                                ></span>
                            </div>
                        </div>
                        <div class="input-group custom">
                            <input type="password"
                                   class="form-control form-control-lg"
                                   placeholder="**********"
                                   required=""
                                   name="password"
                                   maxlength="150"
                                   id="id_password"
                                   autofocus=""/>
                            <div class="input-group-append custom">
                            <span class="input-group-text"><i class="dw dw-padlock1"></i
                        ></span>
                    </div>
                </div>
                <div id="succesLogin"
                     style="display: none;"
                     class="alert alert-success alert-dismissible fade show text-center"
                     role="alert">
                    <strong><span id="error1"></span></strong>
                    <span id="error2"></span>
                    <button id="hide_msg" type="button" class="close"  aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div id="errorlogin2"
                     style="display: none;"
                     class="alert alert-warning alert-dismissible fade show text-center"
                     role="alert">
                    <strong><span id="error1"></span></strong>
                    <span id="error2"></span>
                    <button id="hide_msg" type="button" class="close"  aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
            <!--<div class="row pb-30">
                    <div class="col-4">
                        
                    </div>
                    <div class="col-8">
                        <div class="forgot-password">
                            <a href="forgot-password.html">Olvidaste la contrase√±a?</a>
                        </div>
                    </div>
                </div>-->
                <div class="row">
                    <div class="col-sm-12">
                        <div class="input-group mb-0">
                            <!--
											use code for form submit
											<input class="btn btn-primary btn-lg btn-block" type="submit" value="Sign In">
-->
                            <button type="button"
                                    onclick="login()"
                                    class="btn btn-primary btn-lg btn-block">INICIAR SESION</button>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>
</div>
</div>
<script>
			(function() {
			  'use strict';
			  window.addEventListener('load', function() {
				// Fetch all the forms we want to apply custom Bootstrap validation styles to
				var forms = document.getElementsByClassName('needs-validation');
				// Loop over them and prevent submission
				var validation = Array.prototype.filter.call(forms, function(form) {
				  form.addEventListener('submit', function(event) {
					if (form.checkValidity() === false) {
					  event.preventDefault();
					  event.stopPropagation();
					}else{
						sign_in_User()
					}                
					form.classList.add('was-validated');
				  }, false);
				});
			  }, false);
			})();
		  
</script>
<script>
			$("#hide_msg").click(function (){    
			  $("#login_error_div").hide()
			});
		  
</script>
<script type="text/javascript">
			function login(){
				username = document.getElementById("id_username").value;
				password = document.getElementById("id_password").value;
				$("#errorlogin2").html("");
				$("#succesLogin").html("");
				$.ajax({
					type:"POST",
					headers: {'X-CSRFToken': '{{ csrf_token }}'},
					url:'{% url 'loginUser' %}',
					data:{
						'username':username,
						'password':password,
					},
					success : function(data){
						if(data['message'] == "Success"){
							$('#errorlogin2').html("").hide(); 
							$('#succesLogin').html("Datos validos").show();  
							location.replace("{% url 'index' %}")
						}
						else if(data['message'] == "inactive"){
							$('#errorlogin2').html("Por favor verifica que tengas permisos").show();  
							
						}
						else{
							$('#errorlogin2').html("Datos invalidos").show();  
						}
					}
				});
			}
		
</script>
<!--s
		  <script>
			$("#id_username").change(function () {
			  var username = $(this).val();
		
			  $.ajax({
				url: '{% url "validate_username" %}',
				data: {
				  'username': username
				},
				dataType: 'json',
				success: function (data) {
				  if (data.is_taken) {
					alert("A user with this username already exists.");
				  }
				}
			  });
		
			});
		  </script>

	
		
		<!-- welcome modal end -->
<!-- js -->
<script src="{% static 'vendors/scripts/core.js' %}"></script>
<script src="{% static 'vendors/scripts/script.min.js' %}"></script>
<script src="{% static 'vendors/scripts/process.js' %}"></script>
<script src="{% static 'vendors/scripts/layout-settings.js' %}"></script>
<!-- Google Tag Manager (noscript) -->
<noscript ><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NXZMQSS" height="0" width="0" style="display: none; visibility: hidden"></iframe
></noscript>
<!-- End Google Tag Manager (noscript) -->
</body>
</html>
